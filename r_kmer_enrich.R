

#input.seq = 'atgcatgcatgcatgcaaaaaatgggggc'
input.seq = 'TGTGTGTATGAAGTTAACTTCAAAGCAAGCTTCTGTGTGTATGAAGTTAACTTCAAAGCAAGCTTCCTGTGCTGAGGGGGTGGGAGGTAAGGGTGTGATGAGGCAGGGCTTCTCCTTTGGCAAAGCCTCTGTAGTCCTTCCTTAGTCACCAGGGAGTTGTGGGAGATATAGACCAGGGTTGCAGGTGCCTGGAGTACAGGGACAGCAGACAGGTCATGGTGGGTGAGGGGTCAGCTGGTGGGGCACAGATGCGTTTCCTCGGCAGTCCACATATTCATAGCTCTGAAAGACCAGCTGCTCTGAATGGCTCAGGTATGAACAGGTCAGGGTGCCCCTGGAGAGGAAGCAGGCCTTGTTGCCATGGCTGGGAGGAAAAGGAAAGCTCTGGCCCCATTATACTGTCTGGGGGTGGGGAGCGGGGAGCTCCCTCATTTGCCCTTCCCTCTGGCTCCCCACTCTGCCAAGGTACCTGGGACAGCTGCCCCACCTGTTTTCCAGCAGCTTCCAGACAGCCCTATGCCTGTTGCCCCTAATAACTTATAGGCAAGGTGAGACTCAGAAAAGGGGCTAGACTTGCTATTCCCAAGAGCCAACAAAGATTCATGGGGTCAGCTTGGAAGACTCTCTGCCCATGAGGTGTAGCTGAGTGAGAATGAAGTCAGAAGTGAGAGCAGGGATACCAGAGCTCCAAGCTCTACTTACTGGATGTGCAAAAGCACATGGTGGACTTTGATTTCCAGCCAGGTACAGATTTTGCTGAGAGAGAAGAAAAGAGAACGTGGGACCACGTGTCACATGGAGCAGCCTGTCAGCTCAGAAGATGCCTGCAGGTCCCAGTTTCCTTACCCCACAGAACTCTTTCCTTCCATCAGGTGCCCCCAAAATGTCACTCCCACCCCTTCCCACCCTTCAGGTGAGTGTAGCAGCATGGCTGCACTATCACTCTGACCTCCACTCACTTGGCCCAGGCACATGCTGGACCCCCATTCAGGAGACAGACAAAACATTCTTCTTCCTCAGCAATGCAGGCTGAAGAGCCCAAGGTCACATATTGTAAAGATTAACCAAATTCCAGCCTGTTTTTCATTCTAATCAAGGTCCAAACAAGCAGAGGCTGGGGACCCTGAACCCTTGCTTATTACATTCTCGGCCATGGGAGGGCAGGCCAGATGCTGGCTGAAGAATTTGCTAAGCAATCAGGAAAGCTGGTGGGTATTAATTGGGTCCCTAAGCCAGGCAAGTGGCTAGGGGAGAAGAGATCAAGGGGTACTCACTATGTGTTTTCATCCCGTATCTTGGTAGCTACTGCGTAAAACATCTGTCAACCAAATGGGCACAGGGTTAGCCCCAACTCCAGCTGCCCCTTTCCCACTACCACACATCCACACACCAGTGGGCAGGGCTGGCCAGGGAGAGGGGAGTCACCTGTTCACTGGCCACTGTGCTGAGGGGGTGGGAGGTAAGGGTGTGATGAGGCAGGGCTTCTCCTTTGGCAAAGCCTCTGTAGTCCTTCCTTAGTCACCAGGGAGTTGTGGGAGATATAGACCAGGGTTGCAGGTGCCTGGAGTACAGGGACAGCAGACAGGTCATGGTGGGTGAGGGGTCAGCTGGTGGGGCACAGATGCGTTTCCTCGGCAGTCCACATATTCATAGCTCTGAAAGACCAGCTGCTCTGAATGGCTCAGGTATGAACAGGTCAGGGTGCCCCTGGAGAGGAAGCAGGCCTTGTTGCCATGGCTGGGAGGAAAAGGAAAGCTCTGGCCCCATTATACTGTCTGGGGGTGGGGAGCGGGGAGCTCCCTCATTTGCCCTTCCCTCTGGCTCCCCACTCTGCCAAGGTACCTGGGACAGCTGCCCCACCTGTTTTCCAGCAGCTTCCAGACAGCCCTATGCCTGTTGCCCCTAATAACTTATAGGCAAGGTGAGACTCAGAAAAGGGGCTAGACTTGCTATTCCCAAGAGCCAACAAAGATTCATGGGGTCAGCTTGGAAGACTCTCTGCCCATGAGGTGTAGCTGAGTGAGAATGAAGTCAGAAGTGAGAGCAGGGATACCAGAGCTCCAAGCTCTACTTACTGGATGTGCAAAAGCACATGGTGGACTTTGATTTCCAGCCAGGTACAGATTTTGCTGAGAGAGAAGAAAAGAGAACGTGGGACCACGTGTCACATGGAGCAGCCTGTCAGCTCAGAAGATGCCTGCAGGTCCCAGTTTCCTTACCCCACAGAACTCTTTCCTTCCATCAGGTGCCCCCAAAATGTCACTCCCACCCCTTCCCACCCTTCAGGTGAGTGTAGCAGCATGGCTGCACTATCACTCTGACCTCCACTCACTTGGCCCAGGCACATGCTGGACCCCCATTCAGGAGACAGACAAAACATTCTTCTTCCTCAGCAATGCAGGCTGAAGAGCCCAAGGTCACATATTGTAAAGATTAACCAAATTCCAGCCTGTTTTTCATTCTAATCAAGGTCCAAACAAGCAGAGGCTGGGGACCCTGAACCCTTGCTTATTACATTCTCGGCCATGGGAGGGCAGGCCAGATGCTGGCTGAAGAATTTGCTAAGCAATCAGGAAAGCTGGTGGGTATTAATTGGGTCCCTAAGCCAGGCAAGTGGCTAGGGGAGAAGAGATCAAGGGGTACTCACTATGTGTTTTCATCCCGTATCTTGGTAGCTACTGCGTAAAACATCTGTCAACCAAATGGGCACAGGGTTAGCCCCAACTCCAGCTGCCCCTTTCCCACTACCACACATCCACACACCAGTGGGCAGGGCTGGCCAGGGAGAGGGGAGTCACCTGTTCACTGGCCAAAGG'
unique(unlist(strsplit(input.seq, split="")))
alphabet=c('a', 't', 'c', 'g')
kmer='atgggc'


is.enriched = function(input.seq, kmer, alphabet){
  kmer = tolower(kmer)
  k = nchar(kmer)
  
  seq.leng = nchar(input.seq)
  input.seq = tolower(input.seq)
  
  count.vec = rep(0, length=4^k)
  possible.kmers = expand.grid(rep(list(alphabet), k), stringsAsFactors=F)
  possible.kmers = apply(possible.kmers, 1, function(x){paste(x, collapse="")})
  names(count.vec) = possible.kmers
  
  # each kmer combination must be unique
  stopifnot( length(unique(names(count.vec))) == length(count.vec) )
  
  for (i in 1:(seq.leng-k+1)){
    cur.kmer = substr(input.seq, start=i, stop=i+k-1)
    count.vec[cur.kmer] = count.vec[cur.kmer] + 1
  }
  if (sum(is.na(count.vec)>0)) {
    warning('There is at least 1 NA in count.vec; something must have gone wrong')
  }
}