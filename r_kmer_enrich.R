

#input.seq = 'atgcatgcatgcatgcaaaaaatgggggc'
input.seq = 'TGTGTGTATGAAGTTAACTTCAAAGCAAGCTTCTGTGTGTATGAAGTTAACTTCAAAGCAAGCTTCCTGTGCTGAGGGGGTGGGAGGTAAGGGTGTGATGAGGCAGGGCTTCTCCTTTGGCAAAGCCTCTGTAGTCCTTCCTTAGTCACCAGGGAGTTGTGGGAGATATAGACCAGGGTTGCAGGTGCCTGGAGTACAGGGACAGCAGACAGGTCATGGTGGGTGAGGGGTCAGCTGGTGGGGCACAGATGCGTTTCCTCGGCAGTCCACATATTCATAGCTCTGAAAGACCAGCTGCTCTGAATGGCTCAGGTATGAACAGGTCAGGGTGCCCCTGGAGAGGAAGCAGGCCTTGTTGCCATGGCTGGGAGGAAAAGGAAAGCTCTGGCCCCATTATACTGTCTGGGGGTGGGGAGCGGGGAGCTCCCTCATTTGCCCTTCCCTCTGGCTCCCCACTCTGCCAAGGTACCTGGGACAGCTGCCCCACCTGTTTTCCAGCAGCTTCCAGACAGCCCTATGCCTGTTGCCCCTAATAACTTATAGGCAAGGTGAGACTCAGAAAAGGGGCTAGACTTGCTATTCCCAAGAGCCAACAAAGATTCATGGGGTCAGCTTGGAAGACTCTCTGCCCATGAGGTGTAGCTGAGTGAGAATGAAGTCAGAAGTGAGAGCAGGGATACCAGAGCTCCAAGCTCTACTTACTGGATGTGCAAAAGCACATGGTGGACTTTGATTTCCAGCCAGGTACAGATTTTGCTGAGAGAGAAGAAAAGAGAACGTGGGACCACGTGTCACATGGAGCAGCCTGTCAGCTCAGAAGATGCCTGCAGGTCCCAGTTTCCTTACCCCACAGAACTCTTTCCTTCCATCAGGTGCCCCCAAAATGTCACTCCCACCCCTTCCCACCCTTCAGGTGAGTGTAGCAGCATGGCTGCACTATCACTCTGACCTCCACTCACTTGGCCCAGGCACATGCTGGACCCCCATTCAGGAGACAGACAAAACATTCTTCTTCCTCAGCAATGCAGGCTGAAGAGCCCAAGGTCACATATTGTAAAGATTAACCAAATTCCAGCCTGTTTTTCATTCTAATCAAGGTCCAAACAAGCAGAGGCTGGGGACCCTGAACCCTTGCTTATTACATTCTCGGCCATGGGAGGGCAGGCCAGATGCTGGCTGAAGAATTTGCTAAGCAATCAGGAAAGCTGGTGGGTATTAATTGGGTCCCTAAGCCAGGCAAGTGGCTAGGGGAGAAGAGATCAAGGGGTACTCACTATGTGTTTTCATCCCGTATCTTGGTAGCTACTGCGTAAAACATCTGTCAACCAAATGGGCACAGGGTTAGCCCCAACTCCAGCTGCCCCTTTCCCACTACCACACATCCACACACCAGTGGGCAGGGCTGGCCAGGGAGAGGGGAGTCACCTGTTCACTGGCCACTGTGCTGAGGGGGTGGGAGGTAAGGGTGTGATGAGGCAGGGCTTCTCCTTTGGCAAAGCCTCTGTAGTCCTTCCTTAGTCACCAGGGAGTTGTGGGAGATATAGACCAGGGTTGCAGGTGCCTGGAGTACAGGGACAGCAGACAGGTCATGGTGGGTGAGGGGTCAGCTGGTGGGGCACAGATGCGTTTCCTCGGCAGTCCACATATTCATAGCTCTGAAAGACCAGCTGCTCTGAATGGCTCAGGTATGAACAGGTCAGGGTGCCCCTGGAGAGGAAGCAGGCCTTGTTGCCATGGCTGGGAGGAAAAGGAAAGCTCTGGCCCCATTATACTGTCTGGGGGTGGGGAGCGGGGAGCTCCCTCATTTGCCCTTCCCTCTGGCTCCCCACTCTGCCAAGGTACCTGGGACAGCTGCCCCACCTGTTTTCCAGCAGCTTCCAGACAGCCCTATGCCTGTTGCCCCTAATAACTTATAGGCAAGGTGAGACTCAGAAAAGGGGCTAGACTTGCTATTCCCAAGAGCCAACAAAGATTCATGGGGTCAGCTTGGAAGACTCTCTGCCCATGAGGTGTAGCTGAGTGAGAATGAAGTCAGAAGTGAGAGCAGGGATACCAGAGCTCCAAGCTCTACTTACTGGATGTGCAAAAGCACATGGTGGACTTTGATTTCCAGCCAGGTACAGATTTTGCTGAGAGAGAAGAAAAGAGAACGTGGGACCACGTGTCACATGGAGCAGCCTGTCAGCTCAGAAGATGCCTGCAGGTCCCAGTTTCCTTACCCCACAGAACTCTTTCCTTCCATCAGGTGCCCCCAAAATGTCACTCCCACCCCTTCCCACCCTTCAGGTGAGTGTAGCAGCATGGCTGCACTATCACTCTGACCTCCACTCACTTGGCCCAGGCACATGCTGGACCCCCATTCAGGAGACAGACAAAACATTCTTCTTCCTCAGCAATGCAGGCTGAAGAGCCCAAGGTCACATATTGTAAAGATTAACCAAATTCCAGCCTGTTTTTCATTCTAATCAAGGTCCAAACAAGCAGAGGCTGGGGACCCTGAACCCTTGCTTATTACATTCTCGGCCATGGGAGGGCAGGCCAGATGCTGGCTGAAGAATTTGCTAAGCAATCAGGAAAGCTGGTGGGTATTAATTGGGTCCCTAAGCCAGGCAAGTGGCTAGGGGAGAAGAGATCAAGGGGTACTCACTATGTGTTTTCATCCCGTATCTTGGTAGCTACTGCGTAAAACATCTGTCAACCAAATGGGCACAGGGTTAGCCCCAACTCCAGCTGCCCCTTTCCCACTACCACACATCCACACACCAGTGGGCAGGGCTGGCCAGGGAGAGGGGAGTCACCTGTTCACTGGCCAAAGG'
unique(unlist(strsplit(input.seq, split="")))
alphabet=c('a', 't', 'c', 'g')
kmer='atgggc'


is.enriched = function(input.seq, kmer, alphabet){
  kmer = tolower(kmer)
  k = nchar(kmer)
  
  seq.leng = nchar(input.seq)
  input.seq = tolower(input.seq)
  
  alphabet = tolower(alphabet)
  
  count.vec = c()
  
  for (i in 1:(seq.leng-k+1)){
    cur.kmer = substr(input.seq, start=i, stop=i+k-1)
    if ( is.null(count.vec[cur.kmer]) || is.na(count.vec[cur.kmer]) ) {
      # if count.vec is null (when i=1) or cur.kmer not yet in count.vec
      count.vec = c(count.vec, 1)
      names(count.vec)[length(count.vec)] = cur.kmer
    } else {
      # if cur.kmer already in count.vec
      count.vec[cur.kmer] = count.vec[cur.kmer] + 1
    }
  }
  
  # each kmer combination must be unique
  stopifnot( length(unique(names(count.vec))) == length(count.vec) )
  # no 0 or NA allowed
  stopifnot( sum( is.na(count.vec) | count.vec==0 )==0 )

}